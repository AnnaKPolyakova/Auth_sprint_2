# Проектная работа 6 спринта

Прокси сервер для работы с приложением auth.  
В случае, если проблемы с сервером - возвращает статус 400 и ответ json  
``` 
{
    "status": false
}
``` 
Переменная окружения MAX_REQUEST_COUNT устанавливает сколько раз подряд может  
прийти плохой ответ от auth прежде чем прокси перестанет отсылать на него 
запросы (status open)

Переменная окружения EX_TIME устанавливает как долго в редис сохраняется 
счетчик кол-ва плохих ответов от auth  

Переменная окружения TIMOUT_FOR_REQUEST устанавливает сколько прокси 
максимально ждет ответа от сервера auth  

Переменная окружения AUTH_HOST устанавливает host на котором находится auth  
сервис

При формировании запроса на прокси токен, метод, параметры, урл после хоста 
указываются так 
как и должны указываться при запросе напрямую к сервису auth  

Технологии и требования:
```
Python 3.9+
Flask
```

### Настройки Docker

##### Установка

* [Подробное руководство по установке](https://docs.docker.com/install/linux/docker-ce/ubuntu/)

### Настройки Docker-compose

##### Установка

* [Подробное руководство по установке](https://docs.docker.com/compose/install/)

### Запуск приложения

#### Перед запуском проекта создаем переменные окружения
Создаем в корне .env и добавляем в него необходимые переменные  
Пример в .env.example - для запуска приложения/тестов целиком в docker  
Пример в .env.example-local - для запуска приложения/тестов локально и 
частично в docker


#### Запуск проекта полностью в контейнерах docker

Запуск самого приложения на 8001 порту  
Редис запускается на порту 6378

* `docker-compose -f auth_proxy_app/docker-compose.yml up --build`

Для остановки контейнера: 
* `docker-compose -f auth_proxy_app/docker-compose.yml down --rmi all`


#### Запуск проекта частично в контейнерах docker

Редис запускается на порту 6378

* `docker-compose -f auth_proxy_app/docker-compose-local.yml up --build`

Для остановки контейнера: 
* `docker-compose -f auth_proxy_app/docker-compose-local.yml down --rmi all`


Документация по адресу:  
http://127.0.0.1:8001/v1/doc/redoc/ or или  
http://127.0.0.1:8001/v1/doc/swagger/  

